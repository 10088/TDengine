system sh/stop_dnodes.sh

system sh/deploy.sh -n dnode1 -i 1
system sh/cfg.sh -n dnode1 -c walLevel -v 1
system sh/cfg.sh -n dnode1 -c maxtablespervnode -v 4
system sh/exec.sh -n dnode1 -s start

sleep 100
sql connect

sql drop database if exists cdb
sql create database if not exists cdb 
sql use cdb
sql create table stb1 (ts timestamp, c1 int, c2 float, c3 bigint, c4 smallint, c5 tinyint, c6 double, c7 bool, c8 binary(10), c9 nchar(9)) TAGS(t1 int, t2 binary(10), t3 double)

sql create table tb1 using stb1 tags(1,'1',1.0)
sql create table tb2 using stb1 tags(2,'2',2.0)
sql create table tb3 using stb1 tags(3,'3',3.0)
sql create table tb4 using stb1 tags(4,'4',4.0)
sql create table tb5 using stb1 tags(5,'5',5.0)
sql create table tb6 using stb1 tags(6,'6',6.0)

sql insert into tb1 values ('2021-05-05 18:19:00',1,1.0,1,1,1,1.0,true ,'1','1')
sql insert into tb1 values ('2021-05-05 18:19:01',2,2.0,2,2,2,2.0,true ,'2','2')
sql insert into tb1 values ('2021-05-05 18:19:02',3,3.0,3,3,3,3.0,false,'3','3')
sql insert into tb1 values ('2021-05-05 18:19:03',4,4.0,4,4,4,4.0,false,'4','4')
sql insert into tb1 values ('2021-05-05 18:19:04',11,11.0,11,11,11,11.0,true ,'11','11')
sql insert into tb1 values ('2021-05-05 18:19:05',12,12.0,12,12,12,12.0,true ,'12','12')
sql insert into tb1 values ('2021-05-05 18:19:06',13,13.0,13,13,13,13.0,false,'13','13')
sql insert into tb1 values ('2021-05-05 18:19:07',14,14.0,14,14,14,14.0,false,'14','14')
sql insert into tb2 values ('2021-05-05 18:19:08',21,21.0,21,21,21,21.0,true ,'21','21')
sql insert into tb2 values ('2021-05-05 18:19:09',22,22.0,22,22,22,22.0,true ,'22','22')
sql insert into tb2 values ('2021-05-05 18:19:10',23,23.0,23,23,23,23.0,false,'23','23')
sql insert into tb2 values ('2021-05-05 18:19:11',24,24.0,24,24,24,24.0,false,'24','24')
sql insert into tb3 values ('2021-05-05 18:19:12',31,31.0,31,31,31,31.0,true ,'31','31')
sql insert into tb3 values ('2021-05-05 18:19:13',32,32.0,32,32,32,32.0,true ,'32','32')
sql insert into tb3 values ('2021-05-05 18:19:14',33,33.0,33,33,33,33.0,false,'33','33')
sql insert into tb3 values ('2021-05-05 18:19:15',34,34.0,34,34,34,34.0,false,'34','34')
sql insert into tb4 values ('2021-05-05 18:19:16',41,41.0,41,41,41,41.0,true ,'41','41')
sql insert into tb4 values ('2021-05-05 18:19:17',42,42.0,42,42,42,42.0,true ,'42','42')
sql insert into tb4 values ('2021-05-05 18:19:18',43,43.0,43,43,43,43.0,false,'43','43')
sql insert into tb4 values ('2021-05-05 18:19:19',44,44.0,44,44,44,44.0,false,'44','44')
sql insert into tb5 values ('2021-05-05 18:19:20',51,51.0,51,51,51,51.0,true ,'51','51')
sql insert into tb5 values ('2021-05-05 18:19:21',52,52.0,52,52,52,52.0,true ,'52','52')
sql insert into tb5 values ('2021-05-05 18:19:22',53,53.0,53,53,53,53.0,false,'53','53')
sql insert into tb5 values ('2021-05-05 18:19:23',54,54.0,54,54,54,54.0,false,'54','54')  
sql insert into tb6 values ('2021-05-05 18:19:24',61,61.0,61,61,61,61.0,true ,'61','61')
sql insert into tb6 values ('2021-05-05 18:19:25',62,62.0,62,62,62,62.0,true ,'62','62')
sql insert into tb6 values ('2021-05-05 18:19:26',63,63.0,63,63,63,63.0,false,'63','63')
sql insert into tb6 values ('2021-05-05 18:19:27',64,64.0,64,64,64,64.0,false,'64','64')
sql insert into tb6 values ('2021-05-05 18:19:28',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
sleep 100

print "column test"
sql select * from stb1
if $rows != 29 then
  return -1
endi
sql select * from stb1 where c1 > 0
if $rows != 28 then
  return -1
endi

sql_error select * from stb1 where c8 > 0
sql_error select * from stb1 where c1 in (0,1);
sql_error select ts,c1,c7 from stb1 where c7 > false
sql_error select ts,c1,c7 from stb1 where ts != '2021-05-05 18:19:27'
sql_error select ts,c1,c7 from stb1 where ts > '2021-05-05 18:19:03.000' or ts > '2021-05-05 18:19:20.000';
sql_error select ts,c1,c7 from stb1 where ts > '2021-05-05 18:19:03.000' and ts > '2021-05-05 18:19:20.000' and ts != '2021-05-05 18:19:22.000';
sql_error select * from stb1 where c1 > NULL;
sql_error select * from stb1 where c1 = NULL;
sql_error select * from stb1 where c1 LIKE '%1';

sql select * from stb1 where c2 > 3.0 or c2 < 60;
if $rows != 28 then
  return -1
endi
sql select * from stb1 where c2 > 3.0 or c2 < 60 and c2 > 50;
if $rows != 25 then
  return -1
endi
sql select * from stb1 where (c2 > 3.0 or c2 < 60) and c2 > 50;
if $rows != 8 then
  return -1
endi

sql select * from stb1 where (c2 > 3.0 or c2 < 60) and c2 > 50 and (c2 != 53 and c2 != 63);
if $rows != 6 then
  return -1
endi

sql select * from stb1 where (c2 > 3.0 or c2 < 60) and c2 > 50 and (c2 != 53 or c2 != 63);
if $rows != 8 then
  return -1
endi

sql select * from stb1 where (c3 > 3.0 or c3 < 60) and c3 > 50 and (c3 != 53 or c3 != 63);
if $rows != 8 then
  return -1
endi

sql select * from stb1 where (c4 > 3.0 or c4 < 60) and c4 > 50 and (c4 != 53 or c4 != 63);
if $rows != 8 then
  return -1
endi

sql select * from stb1 where (c5 > 3.0 or c5 < 60) and c5 > 50 and (c5 != 53 or c5 != 63);
if $rows != 8 then
  return -1
endi

sql select * from stb1 where (c6 > 3.0 or c6 < 60) and c6 > 50 and (c6 != 53 or c6 != 63);
if $rows != 8 then
  return -1
endi

sql select * from stb1 where c8 = '51';
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi

sql select * from stb1 where c8 != '51';
if $rows != 27 then
  return -1
endi

sql select * from stb1 where c8 = '51' and c8 != '51';
if $rows != 0 then
  return -1
endi

sql select * from stb1 where c8 = '51' or c8 != '51';
if $rows != 28 then
  return -1
endi

sql select * from stb1 where c9 = '51';
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi

sql select * from stb1 where c9 != '51';
if $rows != 27 then
  return -1
endi

sql select * from stb1 where c9 = '51' and c9 != '51';
if $rows != 0 then
  return -1
endi

sql select * from stb1 where c9 = '51' or c9 != '51';
if $rows != 28 then
  return -1
endi

sql select ts,c1,c7 from stb1 where c7 = false
if $rows != 14 then
  return -1
endi
if $data00 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data01 != 3 then
  return -1
endi
if $data02 != 0 then
  return -1
endi
if $data10 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data11 != 4 then
  return -1
endi
if $data12 != 0 then
  return -1
endi
if $data20 != @21-05-05 18:19:06.000@ then
  return -1
endi
if $data21 != 13 then
  return -1
endi
if $data22 != 0 then
  return -1
endi
if $data30 != @21-05-05 18:19:07.000@ then
  return -1
endi
if $data31 != 14 then
  return -1
endi
if $data32 != 0 then
  return -1
endi


sql select ts,c1,c7 from stb1 where c7 = true
if $rows != 14 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
if $data02 != 1 then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data11 != 2 then
  return -1
endi
if $data12 != 1 then
  return -1
endi
if $data20 != @21-05-05 18:19:04.000@ then
  return -1
endi
if $data21 != 11 then
  return -1
endi
if $data22 != 1 then
  return -1
endi
if $data30 != @21-05-05 18:19:05.000@ then
  return -1
endi
if $data31 != 12 then
  return -1
endi
if $data32 != 1 then
  return -1
endi


sql select * from stb1 where c8 = '51' or c8 = '4'
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data01 != 4 then
  return -1
endi
if $data10 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data11 != 51 then
  return -1
endi


sql select * from stb1 where c1 > 50 and c1 > 53
if $rows != 5 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 and c1 < 52
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 or c1 < 51
if $rows != 28 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 or c1 < 51
if $rows != 25 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 and c1 < 51
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 and c1 > 51 and c1 > 54
if $rows != 4 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 and c1 > 51 or c1 > 54
if $rows != 5 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 and c1 < 51 or c1 > 54
if $rows != 4 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 or c1 < 51 and c1 > 54
if $rows != 5 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 or c1 > 51 and c1 < 54
if $rows != 7 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 and c1 < 51 and c1 > 54
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 and c1 > 53 or c1 < 51 or c1 > 54
if $rows != 25 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 and c1 < 51 or c1 > 54
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 or c1 < 51 and c1 > 54
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 or c1 > 51 and c1 > 54
if $rows != 8 then
  return -1
endi
sql select * from stb1 where c1 > 50 or c1 > 53 or c1 < 51 or c1 > 54
if $rows != 28 then
  return -1
endi

sql select * from stb1 where (c1 > 50 and c1 > 53) and c1 < 52
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 and c1 < 52)
if $rows != 0 then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) or c1 < 51
if $rows != 28 then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 or c1 < 51)
if $rows != 28 then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53) or c1 < 51
if $rows != 25 then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 or c1 < 51)
if $rows != 5 then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) and c1 < 51
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 and c1 < 51)
if $rows != 8 then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53) and (c1 < 51 and c1 > 54)
if $rows != 0 then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53 and c1 < 51) and c1 > 54
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 and c1 < 51) and c1 > 54
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 and c1 < 51 or c1 > 54)
if $rows != 4 then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53) or (c1 < 51 and c1 > 54)
if $rows != 5 then
  return -1
endi
if $data00 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 or c1 < 51) and c1 > 54
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53 or c1 < 51) and c1 > 54
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 or c1 < 51 and c1 > 54)
if $rows != 5 then
  return -1
endi
if $data00 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) and (c1 < 51 and c1 > 54)
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 and c1 < 51 and c1 > 54)
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53 and c1 < 51) and c1 > 54
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 and c1 < 51) and c1 > 54
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53) or (c1 < 51 or c1 > 54)
if $rows != 25 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 or c1 < 51 or c1 > 54)
if $rows != 5 then
  return -1
endi
if $data00 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 and c1 > 53 or c1 < 51) or c1 > 54
if $rows != 25 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 and (c1 > 53 or c1 < 51) or c1 > 54
if $rows != 5 then
  return -1
endi
if $data00 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) and (c1 < 51 or c1 > 54)
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 and c1 < 51 or c1 > 54)
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53 and c1 < 51) or c1 > 54
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 and c1 < 51) or c1 > 54
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) or (c1 < 51 and c1 > 54)
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53 or c1 < 51) and c1 > 54
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 or c1 < 51 and c1 > 54)
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 or c1 < 51) and c1 > 54
if $rows != 8 then
  return -1
endi
if $data00 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:21.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where c1 > 62 or (c1 > 53 or c1 < 51) and c1 > 54
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:25.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:26.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:27.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53) or (c1 < 51 or c1 > 54)
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 or c1 < 51 or c1 > 54)
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select * from stb1 where (c1 > 50 or c1 > 53 or c1 < 51) or c1 > 54
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select * from stb1 where c1 > 50 or (c1 > 53 or c1 < 51) or c1 > 54
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:04.000@ then
  return -1
endi
sql select ts,c1 from stb1 where (c1 > 60 or c1 < 10 or (c1 > 20 and c1 < 30)) and ts > '2021-05-05 18:19:00.000' and ts < '2021-05-05 18:19:25.000' and c1 != 21 and c1 != 22
if $rows != 6 then
  return -1
endi
if $data00 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data01 != 2 then
  return -1
endi
if $data10 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data11 != 3 then
  return -1
endi
if $data20 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data21 != 4 then
  return -1
endi
if $data30 != @21-05-05 18:19:10.000@ then
  return -1
endi
if $data31 != 23 then
  return -1
endi
if $data40 != @21-05-05 18:19:11.000@ then
  return -1
endi
if $data41 != 24 then
  return -1
endi
if $data50 != @21-05-05 18:19:24.000@ then
  return -1
endi
if $data51 != 61 then
  return -1
endi


sql select * from stb1 where (c1 > 40 or c1 < 20) and (c2 < 53 or c2 >= 63) and c3 > 1 and c3 < 5
if $rows != 3 then
  return -1
endi
if $data00 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data01 != 2 then
  return -1
endi
if $data10 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data11 != 3 then
  return -1
endi
if $data20 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data21 != 4 then
  return -1
endi

sql select * from stb1 where (c1 > 52 or c1 < 10) and (c2 > 1 and c2 < 61)
if $rows != 5 then
  return -1
endi
if $data00 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data01 != 2 then
  return -1
endi
if $data10 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data11 != 3 then
  return -1
endi
if $data20 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data21 != 4 then
  return -1
endi
if $data30 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data31 != 53 then
  return -1
endi
if $data40 != @21-05-05 18:19:23.000@ then
  return -1
endi
if $data41 != 54 then
  return -1
endi

sql select * from stb1 where (c3 > 52 or c3 < 10) and (c4 > 1 and c4 < 61) and (c5 = 2 or c6 = 3.0 or c6 = 4.0 or c6 = 53);
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:01.000@ then
  return -1
endi
if $data01 != 2 then
  return -1
endi
if $data10 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data11 != 3 then
  return -1
endi
if $data20 != @21-05-05 18:19:03.000@ then
  return -1
endi
if $data21 != 4 then
  return -1
endi
if $data30 != @21-05-05 18:19:22.000@ then
  return -1
endi
if $data31 != 53 then
  return -1
endi

sql select * from stb1 where c1 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c2 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c3 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c4 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c5 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c6 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c7 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c8 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c9 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi

sql select * from stb1 where c1 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c2 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c3 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c4 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c5 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c6 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c7 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c8 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c9 is not null;
if $rows != 28 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data01 != 1 then
  return -1
endi
sql select * from stb1 where c1 > 63 or c1 is null;
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:27.000@ then
  return -1
endi
if $data01 != 64 then
  return -1
endi
if $data10 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data11 != NULL then
  return -1
endi
sql select * from stb1 where c1 is null and c2 is null;
if $rows != 1 then
  return -1
endi
if $data00 != @21-05-05 18:19:28.000@ then
  return -1
endi
if $data01 != NULL then
  return -1
endi
sql select * from stb1 where c1 is null and c2 is null and c3 is not null;
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 is null and c2 is null and ts > '2021-05-05 18:19:00.000' and ts < '2021-05-05 18:19:28.000';
if $rows != 0 then
  return -1
endi
sql select * from stb1 where c1 = 3 or c1 = 5 or c1 >= 44 and c1 <= 52;
if $rows != 4 then
  return -1
endi
if $data00 != @21-05-05 18:19:02.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:19.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:21.000@ then
  return -1
endi

sql select * from stb1 where c8 LIKE '%1';
if $rows != 7 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:04.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:08.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:12.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:16.000@ then
  return -1
endi
if $data50 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data60 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where c9 LIKE '%1';
if $rows != 7 then
  return -1
endi
if $data00 != @21-05-05 18:19:00.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:04.000@ then
  return -1
endi
if $data20 != @21-05-05 18:19:08.000@ then
  return -1
endi
if $data30 != @21-05-05 18:19:12.000@ then
  return -1
endi
if $data40 != @21-05-05 18:19:16.000@ then
  return -1
endi
if $data50 != @21-05-05 18:19:20.000@ then
  return -1
endi
if $data60 != @21-05-05 18:19:24.000@ then
  return -1
endi
sql select * from stb1 where (c8 LIKE '%1' or c9 like '_2') and (c5 > 50 or c6 > 30) and ( c8 like '3_' or c9 like '4_') and (c4 <= 31 or c4 >= 42);
if $rows != 2 then
  return -1
endi
if $data00 != @21-05-05 18:19:12.000@ then
  return -1
endi
if $data10 != @21-05-05 18:19:17.000@ then
  return -1
endi

print "ts test"

print "tbname test"

print "tag test"

print "join test"




print "column&ts test"

print "column&tbname test"



print "column&tag test"
#sql_error select * from stb1 where t1 > 0 or c1 > 0
#sql_error select * from stb1 where c1 > 0 or t1 > 0
#sql_error select * from stb1 where t1 > 0 or c1 > 0 or t1 > 1
#sql_error select * from stb1 where c1 > 0 or t1 > 0 or c1 > 1
#sql_error select * from stb1 where t1 > 0 and c1 > 0 or t1 > 1
#sql_error select * from stb1 where c1 > 0 or t1 > 0 and c1 > 1
#sql_error select * from stb1 where c1 > 0 or t1 > 0 and c1 > 1
#sql_error select * from stb1 where t1 > 0 or t1 > 0 and c1 > 1
#sql_error select * from stb1 where (c1 > 0 and t1 > 0 ) or (t1 > 1 and c1 > 3)
#sql_error select * from stb1 where (c1 > 0 and t1 > 0 ) or t1 > 1
#
#
#sql select * from stb1 where c1 > 0 and t1 > 0
#sql select * from stb1 where t1 > 0 and c1 > 0
#sql select * from stb1 where t1 > 0 and t1 > 3 and c1 > 1
#sql select * from stb1 where t1 > 0 and c1 > 0 and t1 > 1
#sql select * from stb1 where c1 > 0 and t1 > 0 and c1 > 1
#sql select * from stb1 where c1 > 0 and (t1 > 0 or t1 > 1)
#sql select * from stb1 where (t1 > 0 or t1 > 2 ) and (c1 > 1 or c1 > 3)
#sql select * from stb1 where c1 > 0 and (t1 > 0 or t1 > 1)

print "column&join test"

print "ts&tbname test"

print "ts&tag test"

print "ts&join test"

print "tbname&tag test"

print "tbname&join test"

print "tag&join test"





print "column&ts&tbname test"

print "column&ts&tag test"

print "column&ts&join test"

print "column&tbname&tag test"

print "column&tbname&join test"
print "column&tag&join test"
print "ts&tbname&tag test"
print "ts&tbname&join test"
print "ts&tag&join test"
print "tbname&tag&join test"




print "column&ts&tbname&tag test"
print "column&ts&tbname&join test"
print "column&ts&tag&join test"
print "column&tbname&tag&join test"
print "ts&tbname&tag&join test"


print "column&ts&tbname&tag&join test"

#system sh/exec.sh -n dnode1 -s stop -x SIGINT
