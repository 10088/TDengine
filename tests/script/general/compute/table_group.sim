system sh/stop_dnodes.sh

system sh/deploy.sh -n dnode1 -i 1
system sh/cfg.sh -n dnode1 -c walLevel -v 1
system sh/cfg.sh -n dnode1 -c minRows -v 10
system sh/exec.sh -n dnode1 -s start
sleep 200
sql connect

$db = m_db_tbg_limit
$tb = ct
$mt = st

sql drop database $db -x step1
step1:
sql create database $db
sql use $db
sql create table $mt ( ts timestamp, f1 int, f2 int ) tags(t int)

$tb1 = ct1
$tb2 = ct2
$tb3 = ct3
$tbnum = 3
$rownum = 10

$x = 0
while $x < $rownum
  $i = 1
  while $i <= $tbnum
    $tbi = $tb . $i
    $inc = $x * 60
    $inc1 = $inc + $i
    $ms = 1601481600000 + $inc1
    $v1 = $x * 10
    $v = $v1 + $i
    sql insert into $tbi using $mt tags( $i ) values ( $ms , $v , $v )
		$i = $i + 1
  endw
  $x = $x + 1
endw

system sh/exec.sh -n dnode1 -s stop -x SIGINT
sleep 500
system sh/exec.sh -n dnode1 -s start
sleep 200
sql connect
sql use $db

$x = 0
while $x < $rownum
  $i = 1
  while $i <= $tbnum
    $tbi = $tb . $i
    $inc = $x * 60
    $inc1 = $inc + $i
    $ms = 1601481700000 + $inc1
    $v1 = $x * 10
    $temp = $rownum * 10
    $v1 = $v1 + $temp
    $v = $v1 + $i
    sql insert into $tbi using $mt tags( $i ) values ( $ms , $v , $v )
		$i = $i + 1
  endw
  $x = $x + 1
endw

system sh/exec.sh -n dnode1 -s stop -x SIGINT
sleep 500
system sh/exec.sh -n dnode1 -s start
sql connect
sql use $db

print ================================ clear
#sql drop database $db
#sql show databases
#if $rows != 0 then
#  return -1
#endi

#system sh/exec.sh -n dnode1 -s stop -x SIGINT

